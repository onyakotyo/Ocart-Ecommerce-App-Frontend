{"ast":null,"code":"import React,{useEffect}from'react';import{withRouter}from'react-router-dom';import{useDispatch,useSelector}from'react-redux';import{Card,CardGroup,Button}from'react-bootstrap';import{LinkContainer}from'react-router-bootstrap';import{createOrder,getOrderDetails,payOrder}from'../../actions/orderActions';//import { CART_REMOVE_ALL_ITEMS }  from '../../constants/cartConstants'\n//import { ORDER_CREATE_RESET } from '../constants/orderConstants'\n//import { USER_DETAILS_RESET } from '../constants/userConstants'\nimport{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";var Success=function Success(_ref){var history=_ref.history,location=_ref.location;var dispatch=useDispatch();var cart=useSelector(function(state){return state.cart;});console.log('CART',cart);//   Calculate prices\nvar addDecimals=function addDecimals(num){return(Math.round(num*100)/100).toFixed(2);};cart.itemsPrice=addDecimals(cart.cartItems.reduce(function(acc,item){return acc+item.price*item.qty;},0));cart.shippingPrice=addDecimals(cart.itemsPrice>100?0:100);cart.taxPrice=addDecimals(Number((0.15*cart.itemsPrice).toFixed(2)));cart.totalPrice=(Number(cart.itemsPrice)+Number(cart.shippingPrice)+Number(cart.taxPrice)).toFixed(2);// const orderDetails = useSelector((state) => state.orderDetails)\n// const { order, loading, error } = orderDetails\nvar userLogin=useSelector(function(state){return state.userLogin;});var userInfo=userLogin.userInfo;// const orderPay = useSelector((state) => state.orderPay)\n// const { loading: loadingPay, success: successPay } = orderPay\n// const orderDeliver = useSelector((state) => state.orderDeliver)\n// const { loading: loadingDeliver, success: successDeliver } = orderDeliver\nuseEffect(function(){if(!userInfo){history.push('/login');}},[history,userInfo]);useEffect(function(){if(!userInfo){//&& cart.cartItems && cart.cartItems === 0\nhistory.push('/login');}else{dispatch(createOrder({orderItems:cart.cartItems,shippingAddress:cart.shippingAddress,//paymentMethod: cart.paymentMethod,\npaymentMethod:'Stripe',itemsPrice:cart.itemsPrice,shippingPrice:cart.shippingPrice,taxPrice:cart.taxPrice,totalPrice:cart.totalPrice}));//dispatch({ type: CART_REMOVE_ALL_ITEMS })\n// window.localStorage.removeItem( \"cartItems\") //remove one item   \n//window.localStorage.removeItem(\"paymentMethod\") //remove one item  \n//window.localStorage.removeItem( \"shippingAddress\") //remove one item   \n}},[history,userInfo,dispatch,cart.cartItems,cart.shippingAddress,cart.paymentMethod,cart.itemsPrice,cart.shippingPrice,cart.taxPrice,cart.totalPrice]);//   const orderId = order._id\n//   useEffect(() => {\n//   if (!userInfo ) {\n//      history.push('/login')\n//   } else {\n//     dispatch(getOrderDetails(orderId))\n//     dispatch(payOrder(orderId))\n//   }\n// }, [history, userInfo, dispatch, orderId])\nreturn/*#__PURE__*/_jsx(_Fragment,{children:/*#__PURE__*/_jsx(CardGroup,{children:/*#__PURE__*/_jsxs(Card,{className:\"text-center\",children:[/*#__PURE__*/_jsx(Card.Header,{as:\"h4\",children:\"Payment Successful\"}),/*#__PURE__*/_jsx(\"i\",{className:\"fas fa-hand-holding-usd fa-lg py-3\"}),/*#__PURE__*/_jsxs(Card.Body,{children:[/*#__PURE__*/_jsx(Card.Title,{children:\"Thank you for your order\"}),/*#__PURE__*/_jsx(Card.Text,{children:\"We are currently processing your order and will send you a confirmation email shortly\"}),/*#__PURE__*/_jsxs(Card.Text,{children:[\"If you have any questions, please email \",'',/*#__PURE__*/_jsx(\"a\",{href:\"mailto:ocartorders@example.com\",children:/*#__PURE__*/_jsx(\"span\",{style:{color:'green'},children:\"ocartorders@example.com\"})})]})]}),/*#__PURE__*/_jsx(Card.Footer,{children:/*#__PURE__*/_jsx(LinkContainer,{to:\"/\",children:/*#__PURE__*/_jsx(Button,{variant:\"primary\",children:\"Continue Shopping\"})})})]})})});};export default withRouter(Success);","map":{"version":3,"sources":["/Users/onesmusnyakotyo/ocart/frontend/src/screens/CheckoutScreen/Success.js"],"names":["React","useEffect","withRouter","useDispatch","useSelector","Card","CardGroup","Button","LinkContainer","createOrder","getOrderDetails","payOrder","Success","history","location","dispatch","cart","state","console","log","addDecimals","num","Math","round","toFixed","itemsPrice","cartItems","reduce","acc","item","price","qty","shippingPrice","taxPrice","Number","totalPrice","userLogin","userInfo","push","orderItems","shippingAddress","paymentMethod","color"],"mappings":"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","sourcesContent":["import React, { useEffect } from 'react';\nimport { withRouter } from 'react-router-dom';\nimport { useDispatch, useSelector } from 'react-redux'\nimport { Card, CardGroup, Button  } from 'react-bootstrap'\nimport { LinkContainer } from 'react-router-bootstrap'\nimport { createOrder, getOrderDetails, payOrder } from '../../actions/orderActions'\n//import { CART_REMOVE_ALL_ITEMS }  from '../../constants/cartConstants'\n//import { ORDER_CREATE_RESET } from '../constants/orderConstants'\n//import { USER_DETAILS_RESET } from '../constants/userConstants'\n\nconst Success = ({history, location}) => {\n\n   const dispatch = useDispatch()\n\n  const cart = useSelector((state) => state.cart)\n\n  console.log('CART', cart)\n\n   //   Calculate prices\n  const addDecimals = (num) => {\n    return (Math.round(num * 100) / 100).toFixed(2)\n  }\n\n  cart.itemsPrice = addDecimals(\n    cart.cartItems.reduce((acc, item) => acc + item.price * item.qty, 0)\n  )\n  cart.shippingPrice = addDecimals(cart.itemsPrice > 100 ? 0 : 100)\n  cart.taxPrice = addDecimals(Number((0.15 * cart.itemsPrice).toFixed(2)))\n\n  cart.totalPrice = (\n    Number(cart.itemsPrice) +\n    Number(cart.shippingPrice) +\n    Number(cart.taxPrice)\n  ).toFixed(2)\n\n\n\n  // const orderDetails = useSelector((state) => state.orderDetails)\n  // const { order, loading, error } = orderDetails\n\n   const userLogin = useSelector((state) => state.userLogin)\n  const { userInfo } = userLogin\n\n  // const orderPay = useSelector((state) => state.orderPay)\n  // const { loading: loadingPay, success: successPay } = orderPay\n\n  // const orderDeliver = useSelector((state) => state.orderDeliver)\n  // const { loading: loadingDeliver, success: successDeliver } = orderDeliver\n\n\n   useEffect(() => {\n    if (!userInfo ) {\n       history.push('/login')\n    } \n  }, [history, userInfo])\n  \n  useEffect(() => {\n\n    if(!userInfo ) {\n      //&& cart.cartItems && cart.cartItems === 0\n      history.push('/login')\n    } else {    \n\n      dispatch(createOrder({\n        orderItems: cart.cartItems,\n        shippingAddress: cart.shippingAddress,\n        //paymentMethod: cart.paymentMethod,\n        paymentMethod: 'Stripe',\n        itemsPrice: cart.itemsPrice,\n        shippingPrice: cart.shippingPrice,\n        taxPrice: cart.taxPrice,\n        totalPrice: cart.totalPrice\n      }))\n\n      //dispatch({ type: CART_REMOVE_ALL_ITEMS })\n\n      // window.localStorage.removeItem( \"cartItems\") //remove one item   \n       //window.localStorage.removeItem(\"paymentMethod\") //remove one item  \n       //window.localStorage.removeItem( \"shippingAddress\") //remove one item   \n\n    }\n  }, [\n        history,\n        userInfo,\n        dispatch,\n        cart.cartItems,\n        cart.shippingAddress,\n        cart.paymentMethod,\n        cart.itemsPrice,\n        cart.shippingPrice,\n        cart.taxPrice,\n        cart.totalPrice\n  ])\n\n  //   const orderId = order._id\n\n  //   useEffect(() => {\n  //   if (!userInfo ) {\n  //      history.push('/login')\n  //   } else {\n  //     dispatch(getOrderDetails(orderId))\n  //     dispatch(payOrder(orderId))\n  //   }\n  // }, [history, userInfo, dispatch, orderId])\n      \n\n  \n\n    \n    \n  \n\n\n  \n\n \n    \n\n\n\n\n  return (\n    \n    <>\n    <CardGroup>\n                \n                <Card className=\"text-center\">\n                    <Card.Header as=\"h4\">Payment Successful</Card.Header>\n                \n                    <i className=\"fas fa-hand-holding-usd fa-lg py-3\" ></i>\n                    <Card.Body>\n                    <Card.Title>Thank you for your order</Card.Title>\n                    <Card.Text>\n                        We are currently processing your order and \n                        will send you a confirmation email shortly\n                    </Card.Text>\n                    <Card.Text>\n                       If you have any questions, please email {''}\n                          <a href=\"mailto:ocartorders@example.com\"><span style={{color: 'green'}}>ocartorders@example.com</span></a>\n                    </Card.Text>\n                    </Card.Body>\n                    <Card.Footer>\n                    <LinkContainer to='/'>\n                        <Button variant=\"primary\">Continue Shopping</Button>\n                    </LinkContainer>\n                    \n                    </Card.Footer>\n                </Card>\n            </CardGroup>\n        </>\n  );\n}\n\nexport default withRouter(Success);"]},"metadata":{},"sourceType":"module"}